// ????????????????????????????????????????????????????????????????
// ?????????????????????????? Tiny App ????????????????????????????
// ????????????????????????????????????????????????????????????????
// ??
// ?? A Twitter Clone Using AJAX
// ?? 
// ?? Created on April 20, 2020
// ?? Published on April 13, 2020
// ??
// ?? npm run local to run server
// ?? uses nodemon as a dev dependency
// ??
// ?? Using Better Comments for color coding
// ?? The following is the color key for app commenting
// ??  Key   Meaning   Hex 
//     ??    Titles    (#24c5ff)
//     ~~    Notes     (#ff9900)
//     ^^    Requests  (#ff69b4)
//     !!    Errors    (#ff0011)
//     ##    DataBase  (#78f022)
//     **    Security  (#9822f2)
//     $$    WARNING   (#fff700)

"use strict";

// ???????????????????????? File Modules ??????????????????????????
const DataHelpers = require("./lib/data-helpers.js");
const routes = require("./routes/tweets");

// ??????????????????????? Vendor Modules ?????????????????????????
const express = require("express");
const bodyParser = require("body-parser");

// ????????????????????????????????????????????????????????????????
// ???????????????????????? Application ???????????????????????????
// ????????????????????????????????????????????????????????????????

// ~~ Set Port
const PORT = 8080;

// ~~ Start APP
const app = express();

// ~~ Parse Body
app.use(bodyParser.urlencoded({ extended: true }));

// ~~ Add Public Assets
app.use(express.static("public"));

// ~~ The in-memory database of tweets. 
// ~~ It's a basic object with an array in it.
const db = require("./lib/in-memory-db");

const initialize = DataHelpers(db)
const tweetsRoutes = routes(initialize)

// ??????????????????????????? Routes ?????????????????????????????
app.use("/tweets", tweetsRoutes);

// ~~ Start Server
app.listen(PORT, () => {
  console.log("Example app listening on port " + PORT);
});
